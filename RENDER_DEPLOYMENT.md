# SoF Event Extractor Render Deployment Guide

This document provides instructions for deploying the SoF Event Extractor (Maritime Document Processing system) on Render.com.

## Architecture

This project consists of two main components:

1. **Backend API (FastAPI)**: Python service that processes maritime documents, extracts events, and provides authentication
2. **Frontend (React)**: User interface for document upload, visualization, and management

## Deployment Steps

### Prerequisites

- A [Render.com](https://render.com) account
- Your code pushed to a Git repository (GitHub, GitLab, etc.)
- API keys for:
  - OpenAI API (for GPT-based extraction)
  - Google AI API (optional, for alternative extraction)

### Option 1: Automatic Deployment via Blueprint

1. Log in to your Render dashboard
2. Click on "New" and select "Blueprint"
3. Connect your Git repository
4. Render will automatically detect the `render.yaml` file and create both services
5. Configure environment variables in the Render dashboard:
   - OPENAI_API_KEY
   - GOOGLE_API_KEY (if using)
   - Any other sensitive variables

### Option 2: Manual Deployment

If you prefer to set up the services manually:

#### Backend Deployment

1. In the Render dashboard, click "New" > "Web Service"
2. Connect to your Git repository
3. Configure the service:
   - **Name**: sof-extractor-backend
   - **Runtime**: Python
   - **Build Command**: `cd backend && pip install --upgrade pip && pip install -r requirements.txt`
   - **Start Command**: `cd backend && gunicorn -k uvicorn.workers.UvicornWorker app:app --bind 0.0.0.0:$PORT`
   - **Advanced** > **Add Environment Variable**: Add all required env variables

#### Frontend Deployment

1. In the Render dashboard, click "New" > "Static Site"
2. Connect to your Git repository
3. Configure the site:
   - **Name**: sof-extractor-frontend
   - **Build Command**: `cd frontend && npm install && npm run build`
   - **Publish Directory**: `frontend/build`
   - **Advanced** > **Add Environment Variable**: 
     - REACT_APP_API_URL: Your backend API URL (e.g., https://sof-extractor-backend.onrender.com)

## Configuration Details

### Important Environment Variables

#### Backend

- `SECRET_KEY`: Used for JWT token signing (auto-generated by Render)
- `OPENAI_API_KEY`: Your OpenAI API key
- `GOOGLE_API_KEY`: Your Google AI API key (optional)
- `DATABASE_URL`: Database connection string (if using a database)
- `UPLOAD_DIR`: Directory for uploaded files
- `RESULTS_DIR`: Directory for processing results

#### Frontend

- `REACT_APP_API_URL`: URL of the backend API service
- `REACT_APP_VERSION`: Application version (optional)

## Persistent Storage

The backend service is configured with a 1GB persistent disk mounted at `/data`. This stores:
- Uploaded documents
- Processing results
- Any other data that needs to persist between deployments

## Post-Deployment

After deployment:

1. Test the frontend by navigating to your frontend URL (e.g., https://sof-extractor-frontend.onrender.com)
2. Test the backend by navigating to the API documentation (e.g., https://sof-extractor-backend.onrender.com/docs)
3. Create an initial admin user using the provided endpoint

## Troubleshooting

- Check logs in the Render dashboard
- Verify environment variables are set correctly
- Ensure CORS settings allow your frontend domain
- For persistent disk issues, check mount paths in the backend service

## Resource Considerations

The free tier on Render has limitations:
- Services will spin down after inactivity
- Limited resources for processing
- Consider upgrading to paid plans for production use
